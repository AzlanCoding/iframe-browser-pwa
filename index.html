<script>
let d = new Date();
//alert(d);

let hrs = d.getHours();
let min = d.getMinutes();
let day = d.getDay();
//let auth = false
//const sec = d.getSeconds();
//alert(hrs);
//alert(min);
function pass() {
  return prompt("Enter Password:", "Unlocked during 10:40am to 11:20am GMT+0800 (Singapore Standard Time)");
}
function word() {
while (true) {
	if (pass() == "void") {
	    //auth = true;
	    break
	}else{
	    alert("invalid password")
	    
	}
}
}
function breaks() {
	if (hrs == 10 && min >= 40) {
		return true
	}else if (hrs == 11 && min < 20) {
		return true
	}else {
		return false
	}
}
if (hrs >= 14 || hrs < 8 || breaks() == true|| day == 0 || day == 6/*|| auth == true*/){
    //alert("pass not needed");
    
}else {
    alert("You are using this webite during school hours. Pls enter the password to bypass. Current time: " + d);
    word();
}
//}
</script>

<!DOCTYPE html>
<html lang="en">
<style>
body {
  background-color: #2C2F33;
}
</style>
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Azlan's iframe Browser">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="cache-control" content="no-cache, must-revalidate, post-check=0, pre-check=0, no-store">
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title> Iframe Browser </title>
  <link rel="canonical" href="https://azlancoding.github.io/iframe-browser-pwa/" />
  <link rel="manifest" href="/iframe-browser-pwa/manifest.webmanifest">
  <meta name="keywords" content="bypass, school, browser in website, cloud browser">
  <link rel="stylesheet" href="css/styles.css">
  <title> iFrame browser </title>
  <script language="javascript">
	function setCookie(c_name,value,exdays){
		var exdate=new Date();exdate.setDate(exdate.getDate() + exdays);
		var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
		document.cookie=c_name + "=" + c_value;
	}

	function getCookie(c_name){
		var c_value = document.cookie;
		var c_start = c_value.indexOf(" " + c_name + "=");
		if (c_start == -1){
			c_start = c_value.indexOf(c_name + "=");
		}
		if (c_start == -1){
			c_value = null;
		}
		else{
			c_start = c_value.indexOf("=", c_start) + 1;
			var c_end = c_value.indexOf(";", c_start);
			if (c_end == -1){
				c_end = c_value.length;
			}
			c_value = unescape(c_value.substring(c_start,c_end));
		}
		return c_value;
	}

	checkSession();

function checkSession(){
   var c = getCookie("visited");
   if (c === "yes") {
     alert("Welcome back! Make sure you have your extension on.");
   } 
	else {
	ext_install();
   }
}
function ext_install() 
	{
  if (window.confirm('An extension is required for this website to work. Do you want to install it now?')) 
   {	
		setCookie("visited", "yes", 365)
		window.location.href='https://chrome.google.com/webstore/detail/ignore-x-frame-headers/gleekbfjekiniecknbkamfmkohkpodhe';
		};
  };

function checkCookie() {
  let user = getCookie("alerted");
  if (user != "") {
    alert("Welcome again !");
	} else 
	{ext_install();}
	
}
   //document.getElementById("myIframe").src = "https://wwf.org";
   var iframe = document.getElementById("myIframe");
   //var website = iframe.src;
   //console.log(website);
   document.addEventListener("scroll", function(event) 
   {
    var style = document.getElementById("myIframe").style;
    style.webkitTransform = style.webkitTransform ? "" : "scale(1)";
   })
   /*function resizeIframe()
   {
    document.getElementById('myIframe').height = 100%;
   }*/
   function ResetBox()
   {
   if(document.getElementById("URL").value == '')
   {document.getElementById("URL").value='';};
   }
   function LoadPage()
   { 
     var objFrame=document.getElementById("myIframe"); 
     objFrame.src=document.getElementById("URL").value;
   }
   var elem = document.documentElement
   function openFullscreen() {
     if (elem.requestFullscreen) 
     {
        elem.requestFullscreen();
     }
     else if (elem.webkitRequestFullscreen) { 
        elem.webkitRequestFullscreen();
     }
     else if (elem.msRequestFullscreen) { 
        elem.msRequestFullscreen();
     }
   }
   function closeFullscreen() {
     if (document.exitFullscreen) 
     {
        document.exitFullscreen();
     } 
     else if (document.webkitExitFullscreen) 
     {
        document.webkitExitFullscreen();
     } 
     else if (document.msExitFullscreen) 
     {
       document.msExitFullscreen();
     }
   }
  </script>
  <style>
  .iframe-container {
    overflow: hidden;
    /* 16:9 aspect ratio */
    padding-top: 56.25%;
    position: relative;
  }
  :root {
  --fallback-title-bar-height: 40px;
}

.draggable {
  app-region: drag;
  /* Pre-fix app-region during standardization process */
  -webkit-app-region: drag;
}

.nonDraggable {
  app-region: no-drag;
  /* Pre-fix app-region during standardization process */
  -webkit-app-region: no-drag;
}

.button {
  background-color: #ffffff; 
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 12px;
  margin: 4px 2px;
  cursor: pointer;
  border-radius: 10px;
}
fieldset {
    border: 0px;
}
}
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
}

#titleBarContainer {
  position: absolute;
  top: env(titlebar-area-y, 0);
  height: env(titlebar-area-height, var(--fallback-title-bar-height));
  width: 100%;
  background-color:#254B85;
}

#titleBar {
  position: absolute;
  top: 0;
  display: flex;
  user-select: none;
  height: 100%;
  //left: env(titlebar-area-x, 0);
  left : 0px;
  width: env(titlebar-area-width, 50%);

  color: #FFFFFF;
  font-weight: bold;
  text-align: center;
}

#titleBar > span {
  margin: auto;
  padding: 0px 16px 0px 16px;
}

#titleBar > input {
  flex: 1;
  margin: 8px;
  border-radius: 5px;
  border: none;
  padding: 8px;
}

#mainContent {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  top: env(titlebar-area-height, var(--fallback-title-bar-height));
  overflow-y: scroll;
}

  
:root {
  --fallback-title-bar-height: 40px;
  --theme-color: #10826b;

  /* The idea is that we will be able to override these for testing,
     but it can also work properly once the env()s are implemented(). */
  --titlebar-area-inset-left: env(titlebar-area-inset-left);
  --titlebar-area-inset-right: env(titlebar-area-inset-right);
  --titlebar-area-inset-top: env(titlebar-area-inset-top);
  --titlebar-area-inset-bottom: env(titlebar-area-inset-bottom);
}

:root.emulateWin {
  --titlebar-area-inset-left: 0;
  --titlebar-area-inset-right: 150px;
  --titlebar-area-inset-top: 0;
  --titlebar-area-inset-bottom: calc(100% - 33px);
}

:root.emulateMac {
  --titlebar-area-inset-left: 50px;
  --titlebar-area-inset-right: 50px;
  --titlebar-area-inset-top: 0;
  --titlebar-area-inset-bottom: calc(100% - 33px);
}
  
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
}

#titleBarContainer {
  position: absolute;
  /* this is assuming that the CSS env()s are undefined when they don't have values. */
  /* top: env(titlebar-area-inset-top, 0);
  bottom: env(titlebar-area-inset-bottom, calc(100% - var(--fallback-title-bar-height))); */
  top: var(--titlebar-area-inset-top, 0);
  bottom: var(--titlebar-area-inset-bottom, calc(100% - var(--fallback-title-bar-height)));
  width: 100%;
  background-color: var(--theme-color);
}

#titleBar {
  position: absolute;
  /* top: env(titlebar-area-inset-top, 0); */
  top: var(--titlebar-area-inset-top, 0);
  display: flex;
  user-select: none;
  height: 100%;
  /* left: env(titlebar-area-inset-left, 0);
  right: env(titlebar-area-inset-right, 0);  */
  left: var(--titlebar-area-inset-left, 0);
  right: var(--titlebar-area-inset-right, 0);

  color: #FFFFFF;
  font-weight: bold;
  text-align: center;

  /* cut off UI so you know that it would flow under the overlay */
  overflow: hidden;
}

#titleBar > span {
  margin: auto;
  padding: 0px 16px 0px 16px;
}

#titleBar > input {
  flex: 1;
  margin: 8px 8px 8px 0;
  border-radius: 5px;
  border: none;
  padding: 8px;
}

.overlayArea > button {
  margin: auto;
}

.draggable {
  -webkit-app-region: drag;
}

.nonDraggable {
  -webkit-app-region: no-drag;
}

#mainContent {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  /* height: env(titlebar-area-inset-bottom, calc(100% - var(--fallback-title-bar-height))); */
  height: var(--titlebar-area-inset-bottom, calc(100% - var(--fallback-title-bar-height)));
  bottom: 0;
  overflow-y: scroll;
}

#mainContent.overlay {
  top: env(safe-area-inset-top);
}

.overflowingDiv {
  height: 200%;
  margin: 25px;
}

.mono {
  font-family: 'Courier New', Courier, monospace;
  white-space: pre;
}

.red {
  color: red;
}

#WCOCssTest {
  /* padding-left: env(titlebar-area-top-inset-left);
  padding-right: env(titlebar-area-top-inset-right);
  padding-top: env(titlebar-area-inset-top);
  padding-bottom: env(titlebar-area-inset-bottom); */
  padding-left: var(--titlebar-area-inset-left);
  padding-right: var(--titlebar-area-inset-right);
  padding-top: var(--titlebar-area-inset-top);
  padding-bottom: var(--titlebar-area-inset-bottom);
  width: 50px;
  height: 50px;
  position: absolute;
}
  </style>
</head>
<body style="background-color:#2C2F33">
<div id="titleBarContainer" style="position:relative; top: 0px; left: 0px;">
      <div id="titleBar" class=" draggable">
        <span class="draggable">Iframe Browser</span>
        <input class="nonDraggable" type="text" ID="URL" placeholder="Enter a URL" value="https://www.google.com"></input>
	<input type="submit" class="frmSubmit" value="Go" onclick="LoadPage()">
        <input type="button" VALUE="&#65513"  onClick="history.back()"> 
        <input type="button" VALUE="&#65515"  onClick="history.forward()"> 
        <input type="button" class="fullscreen" value="&#x26F6;" onclick="openFullscreen()">
        <input type="button" class="Exitfullscreen" value="Exit Fullscreen" onclick="closeFullscreen()">
        <input type="button" class="newWindow" value="New Window" onclick=" window.open('https://azlancoding.github.io/iframe-browser-pwa/','_blank')">
        <input type="button" class="cloudbrowser" value="Cloud Browser" onclick="window.open('https://replit.com/@azlancoding/free-and-unlimited-cloud-browser?embed=true','_blank')">
      </div>
    </div>
<!div style="Clear:both;"> 
 <!input type="text" value="https://www.google.com" class="frmUrlVal" ID="URL" placeholder = "Enter a URL" >
<!/div>
<div>
<iframe align="top" width="100%" height="100%" src="https://www.google.com" onload = "check()" onerror"ext_install()" allow="camera;microphone" frameborder=yes loading ="lazy" name="myIframe" id="myIframe"> </iframe>
</div>
<script>
function check(){
  document.getElementById("URL").value = "";
}
</script>
  <script>
      if (navigator.serviceWorker) {
        navigator.serviceWorker.register (
          '/iframe-browser-pwa/sw.js',
          {scope: '/iframe-browser-pwa/'}
        )
      }
  </script>
  <script src="js/app.js"></script>
</body>
</html>
